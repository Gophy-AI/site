---
const scopes = [
  {
    id: 'bizdev',
    name: 'Business Development',
    description: 'Past conversations, objection handling, competitor mentions - all surfaced in real-time.',
  },
  {
    id: 'architecture',
    name: 'Architecture',
    description: 'ADRs, system diagrams, tech debt discussions - instantly retrieved when you need them.',
  },
  {
    id: 'project',
    name: 'Project Management',
    description: 'Sprint commitments, blockers, dependencies - your copilot tracks it all.',
  },
  {
    id: 'product',
    name: 'Product Management',
    description: 'OKRs, PRDs, stakeholder priorities - always aligned with your goals.',
  }
];
---

<section class="pt-32 pb-20 px-4">
  <div class="max-w-4xl mx-auto text-center">
    <!-- Main Headline -->
    <h1 class="text-5xl md:text-6xl font-bold tracking-tight text-gray-900 mb-6">
      Your AI
      <span class="text-brand-500">Meeting Copilot</span>
    </h1>

    <p class="text-xl text-gray-600 mb-12 max-w-2xl mx-auto leading-relaxed">
      It remembers what you discussed. Past decisions, context, people - surfaced exactly when you need them.
    </p>

    <!-- Scope Carousel -->
    <div id="scope-content" class="mb-10 cursor-pointer select-none h-24 md:h-20">
      {scopes.map((scope, index) => (
        <div
          id={`content-${scope.id}`}
          class:list={[
            'transition-opacity duration-300',
            index === 0 ? 'block' : 'hidden'
          ]}
        >
          <p class="text-lg md:text-xl font-medium text-brand-500 mb-2">{scope.name}</p>
          <p class="text-base md:text-lg text-gray-600 max-w-xl mx-auto">{scope.description}</p>
        </div>
      ))}
    </div>

    <!-- Carousel dots -->
    <div class="mb-8">
      <div class="flex justify-center gap-2">
        {scopes.map((scope, index) => (
          <button
            id={`dot-${scope.id}`}
            aria-label={scope.name}
            class:list={[
              'h-2 rounded-full transition-all cursor-pointer',
              index === 0 ? 'bg-brand-500 w-6' : 'bg-gray-300 w-2'
            ]}
          />
        ))}
      </div>
    </div>

    <!-- CTAs -->
    <div class="flex flex-col sm:flex-row gap-4 justify-center">
      <a
        href="https://chrome.google.com/webstore"
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center justify-center bg-brand-500 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-brand-600 transition-colors shadow-lg shadow-brand-500/25"
      >
        Get Started Free
      </a>
      <a
        href="#how-it-works"
        class="inline-flex items-center justify-center border border-gray-300 text-gray-700 px-8 py-4 rounded-lg text-lg font-semibold hover:bg-gray-50 transition-colors"
      >
        See How it Works
      </a>
    </div>

    <p class="mt-6 text-sm text-gray-500">
      Works with Google Meet, Zoom, and Microsoft Teams.
    </p>
  </div>
</section>

<script>
  const scopes = ['bizdev', 'architecture', 'project', 'product'];
  let currentIndex = 0;
  let autoRotateInterval: ReturnType<typeof setInterval> | null = null;

  function setActiveScope(activeId: string) {
    currentIndex = scopes.indexOf(activeId);

    scopes.forEach(id => {
      const dot = document.getElementById(`dot-${id}`);
      const content = document.getElementById(`content-${id}`);

      if (id === activeId) {
        dot?.classList.add('bg-brand-500', 'w-6');
        dot?.classList.remove('bg-gray-300', 'w-2');
        content?.classList.remove('hidden');
        content?.classList.add('block');
      } else {
        dot?.classList.remove('bg-brand-500', 'w-6');
        dot?.classList.add('bg-gray-300', 'w-2');
        content?.classList.add('hidden');
        content?.classList.remove('block');
      }
    });
  }

  function nextScope() {
    currentIndex = (currentIndex + 1) % scopes.length;
    setActiveScope(scopes[currentIndex]);
  }

  function prevScope() {
    currentIndex = (currentIndex - 1 + scopes.length) % scopes.length;
    setActiveScope(scopes[currentIndex]);
  }

  // Click handlers for dots
  scopes.forEach(id => {
    document.getElementById(`dot-${id}`)?.addEventListener('click', () => {
      setActiveScope(id);
      resetAutoRotate();
    });
  });

  // Auto-rotate
  function startAutoRotate() {
    autoRotateInterval = setInterval(nextScope, 4000);
  }

  function resetAutoRotate() {
    if (autoRotateInterval) {
      clearInterval(autoRotateInterval);
    }
    startAutoRotate();
  }

  // Start auto-rotate
  startAutoRotate();

  // Click on content to advance
  const contentArea = document.getElementById('scope-content');

  contentArea?.addEventListener('click', () => {
    nextScope();
    resetAutoRotate();
  });

  // Touch swipe support
  let touchStartX = 0;

  contentArea?.addEventListener('touchstart', (e) => {
    touchStartX = e.changedTouches[0].screenX;
  }, { passive: true });

  contentArea?.addEventListener('touchend', (e) => {
    const touchEndX = e.changedTouches[0].screenX;
    const diff = touchStartX - touchEndX;

    if (Math.abs(diff) > 50) {
      if (diff > 0) {
        nextScope();
      } else {
        prevScope();
      }
      resetAutoRotate();
    }
  }, { passive: true });
</script>
